id: CVE-2016-3978

info:
  name: FortiOS (Fortinet) - Open Redirect and XSS
  author: 0x_Akoko
  severity: medium
  description: The Web User Interface (WebUI) in FortiOS 5.0.x before 5.0.13, 5.2.x before 5.2.3, and 5.4.x before 5.4.0 allows remote attackers to redirect users to arbitrary web sites and conduct phishing attacks or cross-site scripting (XSS) attacks via the "redirect" parameter to "login."
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2016-3978
    - https://seclists.org/fulldisclosure/2016/Mar/68
    - http://www.fortiguard.com/advisory/fortios-open-redirect-vulnerability
  tags: cve,cve216,redirect,fortinet,fortios

requests:
  - method: GET
    path:
      - '{{BaseURL}}/login?redir=http://www.example.com'

    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)?(?:[a-zA-Z0-9\-_\.@]*)example\.com\/?(\/|[^.].*)?$' # https://regex101.com/r/ZDYhFh/1