id: eyesofnetwork-detect

info:
  name: EyesOfNetwork Vulnerable Version Detect
  author: praetorian-thendrickson
  severity: high
  description: EyesOfNetwork version 5.1-5.3 is vulnerable to multiple exploits. Version 5.3 is vulnerable to CVE-2020-8654 (authenticated rce), CVE-2020-8655 (privesc), CVE-2020-8656 (SQLi - API version before 2.4.2), and 2020-8657 (hardcoded api key). Versions 5.1-5.3 are vulnerable to CVE-2020-9465 (SQLi).
  tags: tech,cisa
  reference: 
    - https://nvd.nist.gov/vuln/detail/CVE-2020-9465
    - https://nvd.nist.gov/vuln/detail/CVE-2020-8656
    - https://nvd.nist.gov/vuln/detail/CVE-2020-8655
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8654
    - https://nvd.nist.gov/vuln/detail/CVE-2020-8657
    - https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/eyesofnetwork_autodiscovery_rce.rb

requests:
  - method: GET
    path:
      - "{{BaseURL}}/css/eonweb.css"
    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "VERSION : 5.[1-3]"
      - type: word
        part: body
        words:
          -  "EyesOfNetwork"
      - type: status
        status:
          - 200