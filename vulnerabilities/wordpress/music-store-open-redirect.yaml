id: music-store-open-redirect

info:
  name: Music Store <= 1.0.14 - Referer Header Open Redirect
  author: dhiyaneshDk
  severity: medium
  description: The Music Store â€“ WordPress eCommerce WordPress plugin was affected by a Referer Header Open Redirect security vulnerability.
  reference: https://wpscan.com/vulnerability/d73f6575-eb86-480c-bde1-f8765870cdd1
  tags: wordpress,redirect,wp-plugin,musicstore

requests:
  - raw:
      - |
        GET /wp-content/plugins/music-store/ms-core/ms-submit.php HTTP/1.1
        Host: {{Hostname}}
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
        Accept-Language: en-US,en;q=0.5
        Accept-Encoding: gzip, deflate
        Referer: https://example.com
        Connection: keep-alive

    matchers:
      - type: regex
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?://|//)?(?:[a-zA-Z0-9\-_\.@]*)example\.com.*$'
        part: header
