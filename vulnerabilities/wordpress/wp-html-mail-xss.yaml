id: wp-html-mail-xss

info:
  name: HTML Email Template Designer < 3.1 - Stored Cross-Site Scripting (XSS)
  author: hexcat
  severity: high
  description: >
    WordPress Email Template Designer â€“ WP HTML Mail allows stored XSS through
    an unprotected REST-API endpoint (CVE-2022-0218).
  reference: https://www.wordfence.com/blog/2022/01/unauthenticated-xss-vulnerability-patched-in-html-email-template-designer-plugin/
  tags: wordpress,wp-plugin,xss

requests:
  - method: GET
    path:
      - "{{BaseURL}}/index.php?rest_route=/whm/v3/themesettings"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "application/json"
        part: header
      - type: word
        words:
          - "footer"
        part: body
