id: tomcat-default-login

info:
  name: Tomcat Default Creds
  author: 0xelkomy & C0NQR0R
  severity: medium
  description: Default Creds and there is XSS here # /examples/jsp/security/protected/index.jsp?dataName=%22%3E%3Cimg+src%3Dd+onerror%3Dalert%28document.cookie%29%3E&dataValue= after you login you will be able to get it.
  tags: creds
  reference:
    - https://c0nqr0r.github.io/CVE-2022-34305/
requests:
  - raw:
      - |
        GET /examples/jsp/security/protected/index.jsp HTTP/1.1
        Host: {{Hostname}}
        Origin: {{BaseURL}}

      - |
        POST /examples/jsp/security/protected/j_security_check;jsessionid={{token}} HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Cookie: JSESSIONID={{session}} ;

        j_username=tomcat&j_password=tomcat
    extractors:
      - type: regex
        name: token
        group: 1
        internal: true
        part: header
        regex:
          - "JSESSIONID=(.*)"
    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - "Location: /examples/jsp/security/protected/index.jsp"
      - type: status
        status:
          - 303
