id: dropbear-weakmac-detect

info:
  name: Dropbear Weak MAC Algorithms Detection
  author: pussycat0x
  severity: low
  description: |
    The mac-alg command specifies which MAC algorithms in the SSH client profile for SSH encryption negotiation with an SFTP server when the DataPower Gateway acts as an SFTP client.
  remediation: |
    Disable MD5 and 96-bit MAC algorithms.
  reference: |
    https://www.virtuesecurity.com/kb/ssh-weak-mac-algorithms-enabled
  metadata:
    verified: true
    shodan-query: 'product:"Dropbear sshd"'
  tags: network,ssh,dropbear

network:
  - inputs:
      - data: "\n"

    host:
      - "{{Hostname}}"
      - "{{Host}}:22"

    matchers:
      - type: regex
        regex:
          - 'SSH\-2\.0\-([a-z_0-9.]+)'

    extractors:
      - type: regex
        regex:
          - 'SSH\-2\.0\-([a-z_0-9.]+)'
