id: niagara-fox-info-enum

info:
  name: Niagara Fox Protocol Information Enumeration
  author: pussycat0x
  severity: info
  description: |
    Niagara Fox Protocol is a building automation protocol used between the Niagara software systems by Tridium.
  metadata:
    verified: true
    shodan-query: 'product:"Niagara Fox"'
  reference:
    - https://nmap.org/nsedoc/scripts/fox-info.html
  tags: network,fox,niagara

network:

  - inputs:
      - data: "fox a 1 -1 fox hello\n{\nfox.version=s:1.0\nid=i:1\n};;\n"
    host:
      - "{{Hostname}}"
      - "{{Host}}:1911"
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "fox"
    extractors:
      - type: regex
        regex:
          - "fox.version=s:([0-9.]+)" #done
          - "hostName=s:([0-9.]+)" #done
          - "hostAddress=s:([0-9.]+)" #done
          - "app.name=s:([A-Za-z0-9]+)" #done
          - "app.version=s:([0-9.]+)" #done
          - "vm.name=s:([A-Za-z ()0-9]+)" #done
          - "vm.version=s:([0-9._-a-z]+)" #done
          - "os.name=s:([A-Z]+)"  #done
          - "os.version=s:([0-9.]+)" #done
          - "station.name=s:([A-Za-z0-9]+)" #done
          - "timeZone=s:([A-Z]+)" #done
          - "hostId=s:([A-Za-z-0-9]+)"
          - "last.hostId=s:([a-z0-9]+)"
          - "brandId=s:([A-Za-z0-9]+)"
