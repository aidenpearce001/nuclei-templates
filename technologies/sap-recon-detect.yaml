id: sap-recon-detect

info:
  name: SAP RECON Finder
  author: samueladi_ & organiccrap
  severity: medium
  tags: tech,sap
  reference: https://github.com/chipik/SAP_RECON

requests:
  - method: GET
    path:
      - "{{BaseURL}}/CTCWebService/CTCWebServiceBean?wsdl"

    matchers-condition: and
    matchers:

      - type: word
        words:
          - CTCManagementException
          - RemoteException
          - cancelExecution
        condition: or

      - type: word
        words:
          - "text/xml"
          - "SAP NetWeaver Application Server"
        part: header

      - type: status
        status:
          - 200