id: glpi-project_glpi-detect

info:
  name: GLPI Detect
  author: Ricardo Maia (Brainfork)
  severity: info
  reference:
    - https://glpi-project.org/
  tags: glpi,service-desk,help-desk,itil
  metadata:
    cpe:
      - cpe:2.3:a:glpi-project:glpi

requests:
- method: GET
  path:
    - "{{BaseURL}}/CHANGELOG.md"
    - "{{BaseURL}}"    
  matchers-condition: or
  matchers:
    - type: word
      condition: or
      words:         
         - "GLPI changes"
         - "glpi-project.org"      
    - type: regex      
      regex:
        - '(GLPI.*[C|c]opyright.*(|Teclib))'        
  extractors:
    - type: regex
      name: version
      part: body
      group: 1
      regex:
        - '# GLPI changes\n\n.*\n.*\n.*\n##\s\[(\d+\.\d+|\d+\.\d+\.\d+)\]'


