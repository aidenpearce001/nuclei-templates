id: jsf-detection

info:
  name: JavaServer Faces Detection
  author: Moritz Nentwig
  severity: info
  description: Searches for JavaServer Faces content on a URL.
  tags: jsf,tech

requests:
  - method: GET
    path:
      - "{{BaseURL}}"

    redirects: true
    max-redirects: 2
    matchers-condition: or
    matchers:
      - type: dsl
        name: javafaces
        dsl:
          - "(contains(tolower(body), 'javax.faces.resource') || contains(tolower(body), 'javax.faces.ViewState'))"

      - type: dsl
        name: primefaces
        dsl:
          - "contains(tolower(body), 'primefaces')"
          - "contains(tolower(body), 'javax.faces.resource') || contains(tolower(body), 'javax.faces.ViewState')"
        condition: and

      - type: dsl
        name: richfaces
        dsl:
          - "contains(tolower(body), 'richfaces')"
          - "contains(tolower(body), 'javax.faces.resource') || contains(tolower(body), 'javax.faces.ViewState')"
        condition: and
