id: joomla-detect

info:
  name: Joomla! Detect
  description: Joomla, also spelled Joomla! (with an exclamation mark) and sometimes abbreviated as J!, is a free and open-source content management system (CMS) for publishing web content on websites.
  author: ricardomaia
  severity: info

  metadata:
    verified: true
    google-dork-administration: '"Joomla! Administration Login" inurl:"/index.php"'
    google-dork-installer: 'intitle:"Joomla â€“ Web Installer"'

  reference:
    - https://www.itoctopus.com/how-to-quickly-know-the-version-of-any-joomla-website
    - https://hackertarget.com/attacking-enumerating-joomla/
  tags: tech,joomla,cms

requests:
  - method: GET # Sorted by confidence level
    path:
      - "{{BaseURL}}/language/en-GB/en-GB.xml" # >= 1.5.0 and <= 1.5.26
      - "{{BaseURL}}/administrator/manifests/files/joomla.xml" # >= 1.6.0
      - "{{BaseURL}}/README.txt"
      - "{{BaseURL}}/modules/custom.xml" # < 1.5.0
      - "{{BaseURL}}" # >= 1.5.0 and <= 1.5.26
    redirects: true
    stop-at-first-match: true
    matchers-condition: or
    matchers:
      - type: regex
        regex:
          - '(?i)<meta.name="generator".content="(Joomla!).*/>'
          - "(?i)<version>(.*)</version>"
          - '(?i)Joomla_([\d.|\d]+)_version_history'
      - type: status
        status:
          - 200
    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?i)<version>(.*)</version>"
          - '(?i)Joomla_([\d.|\d]+)_version_history'
